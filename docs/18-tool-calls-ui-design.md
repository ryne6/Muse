# Tool Calls UI è®¾è®¡

## ç›®æ ‡
åœ¨å¯¹è¯ä¸­å¯è§†åŒ–æ˜¾ç¤º AI çš„å·¥å…·è°ƒç”¨è¿‡ç¨‹ï¼Œè®©ç”¨æˆ·æ¸…æ¥šåœ°çœ‹åˆ° AI æ‰§è¡Œäº†å“ªäº›æ“ä½œã€‚

## UI è®¾è®¡

### å·¥å…·è°ƒç”¨å¡ç‰‡
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”§ read_file                            â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ path: "src/main.ts"                 â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ âœ… Success  â€¢  125 lines               â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ import { app } from 'electron'      â”‚ â”‚
â”‚ â”‚ ...                                 â”‚ â”‚
â”‚ â”‚ [Show More]                         â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### çŠ¶æ€æ ‡è¯†
- ğŸ”„ **æ‰§è¡Œä¸­**: è“è‰²è¾¹æ¡†ï¼Œloading spinner
- âœ… **æˆåŠŸ**: ç»¿è‰²è¾¹æ¡†ï¼Œcheck å›¾æ ‡
- âŒ **å¤±è´¥**: çº¢è‰²è¾¹æ¡†ï¼Œerror å›¾æ ‡

### å·¥å…·ç±»å‹å›¾æ ‡
- ğŸ“„ read_file
- âœï¸ write_file
- ğŸ“ edit_file
- ğŸ” search_files
- ğŸ“ list_directory

## æ•°æ®ç»“æ„

### Message ç±»å‹ï¼ˆå·²å®šä¹‰ï¼‰
```typescript
interface Message {
  id: string
  role: 'user' | 'assistant'
  content: string
  timestamp: number
  toolCalls?: ToolCall[]      // å·¥å…·è°ƒç”¨
  toolResults?: ToolResult[]  // å·¥å…·ç»“æœ
}

interface ToolCall {
  id: string
  name: string
  input: Record<string, any>
}

interface ToolResult {
  toolCallId: string
  output: string
  isError?: boolean
}
```

## ç»„ä»¶ç»“æ„

### 1. ToolCallCard ç»„ä»¶
æ˜¾ç¤ºå•ä¸ªå·¥å…·è°ƒç”¨åŠå…¶ç»“æœ

```tsx
interface ToolCallCardProps {
  toolCall: ToolCall
  toolResult?: ToolResult
  status: 'pending' | 'success' | 'error'
}

function ToolCallCard({ toolCall, toolResult, status }: ToolCallCardProps) {
  // æ˜¾ç¤ºå·¥å…·åç§°ã€å‚æ•°ã€çŠ¶æ€ã€ç»“æœ
}
```

### 2. ToolCallsList ç»„ä»¶
æ˜¾ç¤ºä¸€æ¡æ¶ˆæ¯ä¸­çš„æ‰€æœ‰å·¥å…·è°ƒç”¨

```tsx
interface ToolCallsListProps {
  toolCalls: ToolCall[]
  toolResults: ToolResult[]
}

function ToolCallsList({ toolCalls, toolResults }: ToolCallsListProps) {
  // æ˜ å°„ toolCalls å’Œ toolResults
  // æ¸²æŸ“å¤šä¸ª ToolCallCard
}
```

### 3. æ›´æ–° MessageItem ç»„ä»¶
åœ¨ AI æ¶ˆæ¯ä¸­é›†æˆå·¥å…·è°ƒç”¨æ˜¾ç¤º

```tsx
export function MessageItem({ message }: MessageItemProps) {
  const isUser = message.role === 'user'

  return (
    <div>
      {/* å·¥å…·è°ƒç”¨ï¼ˆä»… AI æ¶ˆæ¯ï¼‰ */}
      {!isUser && message.toolCalls && message.toolCalls.length > 0 && (
        <ToolCallsList
          toolCalls={message.toolCalls}
          toolResults={message.toolResults || []}
        />
      )}

      {/* æ–‡æœ¬å†…å®¹ */}
      {message.content && (
        <div>
          {isUser ? (
            <div>{message.content}</div>
          ) : (
            <MarkdownRenderer content={message.content} />
          )}
        </div>
      )}
    </div>
  )
}
```

## æ˜¾ç¤ºé€»è¾‘

### å‚æ•°æ˜¾ç¤º
æ ¹æ®å‚æ•°ç±»å‹æ™ºèƒ½æ˜¾ç¤ºï¼š
- çŸ­å­—ç¬¦ä¸²ï¼šç›´æ¥æ˜¾ç¤º
- é•¿å­—ç¬¦ä¸²ï¼šæŠ˜å æ˜¾ç¤ºï¼Œ"Show More" æŒ‰é’®
- å¯¹è±¡/æ•°ç»„ï¼šæ ¼å¼åŒ– JSON æ˜¾ç¤º

### ç»“æœæ˜¾ç¤º
æ ¹æ®ç»“æœç±»å‹å’Œå¤§å°ï¼š
- å°äº 200 å­—ç¬¦ï¼šå®Œæ•´æ˜¾ç¤º
- å¤§äº 200 å­—ç¬¦ï¼šæ˜¾ç¤ºå‰ 200 å­—ç¬¦ + "Show More"
- é”™è¯¯ï¼šçº¢è‰²é«˜äº®æ˜¾ç¤º

### æŠ˜å åŠŸèƒ½
- é»˜è®¤å±•å¼€æ˜¾ç¤ºå‚æ•°
- é»˜è®¤æŠ˜å å¤§å‹ç»“æœ
- ç‚¹å‡»å¯å±•å¼€/æŠ˜å 

## æ ·å¼è®¾è®¡

### é¢œè‰²æ–¹æ¡ˆ
```css
/* æ‰§è¡Œä¸­ */
.tool-call-pending {
  border-color: hsl(var(--primary));
  background: hsl(var(--primary) / 0.05);
}

/* æˆåŠŸ */
.tool-call-success {
  border-color: hsl(142 76% 36%);
  background: hsl(142 76% 36% / 0.05);
}

/* å¤±è´¥ */
.tool-call-error {
  border-color: hsl(var(--destructive));
  background: hsl(var(--destructive) / 0.05);
}
```

### å¸ƒå±€
- å·¥å…·è°ƒç”¨å¡ç‰‡åœ¨æ¶ˆæ¯å†…å®¹ä¹‹å‰æ˜¾ç¤º
- å¤šä¸ªå·¥å…·è°ƒç”¨å‚ç›´å †å 
- å¡ç‰‡ä¹‹é—´æœ‰é€‚å½“é—´è·

## å®ç°ä¼˜å…ˆçº§

### é«˜ä¼˜å…ˆçº§
- [x] ToolCallCard åŸºç¡€ç»„ä»¶
- [x] çŠ¶æ€æ˜¾ç¤ºï¼ˆpending/success/errorï¼‰
- [x] å‚æ•°æ˜¾ç¤º
- [x] ç»“æœæ˜¾ç¤º
- [x] é›†æˆåˆ° MessageItem

### ä¸­ä¼˜å…ˆçº§
- [ ] æŠ˜å /å±•å¼€åŠŸèƒ½
- [ ] å·¥å…·ç±»å‹å›¾æ ‡
- [ ] å¤åˆ¶æŒ‰é’®ï¼ˆå¤åˆ¶ç»“æœï¼‰
- [ ] åŠ¨ç”»æ•ˆæœ

### ä½ä¼˜å…ˆçº§
- [ ] æ€§èƒ½ç»Ÿè®¡ï¼ˆæ‰§è¡Œæ—¶é—´ï¼‰
- [ ] å·¥å…·è°ƒç”¨å†å²
- [ ] å¯¼å‡ºå·¥å…·è°ƒç”¨æ—¥å¿—

## ç¤ºä¾‹åœºæ™¯

### åœºæ™¯ 1: è¯»å–æ–‡ä»¶
```
ç”¨æˆ·: "è¯»å– src/main.ts æ–‡ä»¶"

AI å›å¤:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”§ read_file                        â”‚
â”‚ path: "src/main.ts"                 â”‚
â”‚ âœ… Success                          â”‚
â”‚ [æ–‡ä»¶å†…å®¹...]                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
æˆ‘å·²ç»è¯»å–äº† src/main.ts æ–‡ä»¶ã€‚
è¿™æ˜¯ä¸€ä¸ª Electron ä¸»è¿›ç¨‹æ–‡ä»¶...
```

### åœºæ™¯ 2: å¤šä¸ªå·¥å…·è°ƒç”¨
```
ç”¨æˆ·: "æœç´¢é¡¹ç›®ä¸­æ‰€æœ‰çš„ TODO æ³¨é‡Š"

AI å›å¤:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”§ search_files                     â”‚
â”‚ pattern: "TODO"                     â”‚
â”‚ âœ… Success â€¢ 5 files                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”§ read_file                        â”‚
â”‚ path: "src/utils.ts"                â”‚
â”‚ âœ… Success                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
æˆ‘æ‰¾åˆ°äº† 5 ä¸ªåŒ…å« TODO æ³¨é‡Šçš„æ–‡ä»¶ï¼š
1. src/utils.ts - ç¬¬ 42 è¡Œ
2. ...
```

### åœºæ™¯ 3: é”™è¯¯å¤„ç†
```
ç”¨æˆ·: "è¯»å–ä¸å­˜åœ¨çš„æ–‡ä»¶"

AI å›å¤:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”§ read_file                        â”‚
â”‚ path: "nonexistent.ts"              â”‚
â”‚ âŒ Error                            â”‚
â”‚ File not found: nonexistent.ts      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
æŠ±æ­‰ï¼Œè¯¥æ–‡ä»¶ä¸å­˜åœ¨ã€‚
```

## æŠ€æœ¯å®ç°ç»†èŠ‚

### å·¥å…·å›¾æ ‡æ˜ å°„
```tsx
const TOOL_ICONS: Record<string, React.ReactNode> = {
  read_file: <FileText className="w-4 h-4" />,
  write_file: <FilePlus className="w-4 h-4" />,
  edit_file: <FileEdit className="w-4 h-4" />,
  search_files: <Search className="w-4 h-4" />,
  list_directory: <Folder className="w-4 h-4" />,
}
```

### çŠ¶æ€è®¡ç®—
```tsx
function getToolCallStatus(
  toolCall: ToolCall,
  toolResults: ToolResult[]
): 'pending' | 'success' | 'error' {
  const result = toolResults.find(r => r.toolCallId === toolCall.id)
  if (!result) return 'pending'
  return result.isError ? 'error' : 'success'
}
```

## æµ‹è¯•åœºæ™¯

1. æµ‹è¯•å•ä¸ªå·¥å…·è°ƒç”¨æ˜¾ç¤º
2. æµ‹è¯•å¤šä¸ªå·¥å…·è°ƒç”¨æ˜¾ç¤º
3. æµ‹è¯•é•¿å‚æ•°/ç»“æœçš„æŠ˜å 
4. æµ‹è¯•é”™è¯¯çŠ¶æ€æ˜¾ç¤º
5. æµ‹è¯•loadingçŠ¶æ€æ˜¾ç¤º
