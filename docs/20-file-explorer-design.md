# æ–‡ä»¶æµè§ˆå™¨è®¾è®¡

## ç›®æ ‡
åœ¨åº”ç”¨å³ä¾§åˆ›å»ºä¸€ä¸ªæ–‡ä»¶æµè§ˆå™¨ï¼Œæ˜¾ç¤ºå·¥ä½œåŒºçš„æ–‡ä»¶æ ‘ç»“æ„ï¼Œæ”¯æŒæ–‡ä»¶ç‚¹å‡»é¢„è§ˆå’Œæœç´¢ã€‚

## UI å¸ƒå±€

### æ•´ä½“å¸ƒå±€
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          â”‚                 â”‚          â”‚
â”‚  Conv    â”‚   Chat View     â”‚  File    â”‚
â”‚  List    â”‚                 â”‚ Explorer â”‚
â”‚          â”‚                 â”‚          â”‚
â”‚ (240px)  â”‚    (flex-1)     â”‚ (280px)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ–‡ä»¶æµè§ˆå™¨ç»“æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“ project-name          [ğŸ”] â”‚  <- Header
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ” Search files...             â”‚  <- Search
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“ src                      â–¼  â”‚  <- Folder (expandable)
â”‚   ğŸ“ components             â–¼  â”‚
â”‚     ğŸ“„ Button.tsx              â”‚
â”‚     ğŸ“„ Input.tsx               â”‚
â”‚   ğŸ“ utils                  â–¶  â”‚  <- Collapsed
â”‚   ğŸ“„ index.ts                  â”‚
â”‚ ğŸ“ docs                     â–¶  â”‚
â”‚ ğŸ“„ package.json                â”‚
â”‚ ğŸ“„ README.md                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## åŠŸèƒ½éœ€æ±‚

### æ ¸å¿ƒåŠŸèƒ½
1. **æ–‡ä»¶æ ‘æ˜¾ç¤º**
   - æ˜¾ç¤ºç›®å½•å’Œæ–‡ä»¶
   - æ”¯æŒå±•å¼€/æŠ˜å ç›®å½•
   - æ˜¾ç¤ºæ–‡ä»¶å›¾æ ‡ï¼ˆæ ¹æ®æ‰©å±•åï¼‰
   - åµŒå¥—ç¼©è¿›æ˜¾ç¤ºå±‚çº§

2. **æ–‡ä»¶äº¤äº’**
   - ç‚¹å‡»æ–‡ä»¶ â†’ è§¦å‘é¢„è§ˆæˆ–åœ¨ AI å¯¹è¯ä¸­æåŠ
   - å³é”®èœå• â†’ å¤åˆ¶è·¯å¾„ã€åœ¨ç³»ç»Ÿä¸­æ‰“å¼€ç­‰

3. **æœç´¢åŠŸèƒ½**
   - å®æ—¶æœç´¢æ–‡ä»¶å
   - é«˜äº®åŒ¹é…ç»“æœ
   - è¿‡æ»¤æ˜¾ç¤ºåŒ¹é…çš„æ–‡ä»¶

4. **æ–‡ä»¶è¿‡æ»¤**
   - å°Šé‡ .gitignore è§„åˆ™
   - éšè— node_modulesã€.git ç­‰
   - å¯é…ç½®çš„è¿‡æ»¤è§„åˆ™

### æ‰©å±•åŠŸèƒ½
- æ–‡ä»¶æ’åºï¼ˆåç§°ã€ç±»å‹ã€ä¿®æ”¹æ—¶é—´ï¼‰
- æ–°å»ºæ–‡ä»¶/æ–‡ä»¶å¤¹
- é‡å‘½åã€åˆ é™¤
- æ–‡ä»¶æ‹–æ‹½æ“ä½œ

## æŠ€æœ¯å®ç°

### 1. å·¥ä½œåŒºç®¡ç†

#### IPC é€šä¿¡
```typescript
// ä¸»è¿›ç¨‹ API
window.api.workspace.listFiles(path: string): Promise<FileNode[]>
window.api.workspace.watchFiles(callback): void
window.api.workspace.unwatchFiles(): void
```

#### æ–‡ä»¶èŠ‚ç‚¹ç±»å‹
```typescript
interface FileNode {
  name: string
  path: string
  type: 'file' | 'directory'
  children?: FileNode[]
  extension?: string
  size?: number
  modifiedAt?: number
}
```

### 2. ç»„ä»¶ç»“æ„

```
FileExplorer/
â”œâ”€â”€ FileExplorer.tsx          # ä¸»å®¹å™¨
â”œâ”€â”€ FileTree.tsx              # æ–‡ä»¶æ ‘
â”œâ”€â”€ FileTreeItem.tsx          # å•ä¸ªæ–‡ä»¶/æ–‡ä»¶å¤¹é¡¹
â”œâ”€â”€ FileSearch.tsx            # æœç´¢æ¡†
â””â”€â”€ FileIcon.tsx              # æ–‡ä»¶å›¾æ ‡ç»„ä»¶
```

### 3. çŠ¶æ€ç®¡ç†

```typescript
interface FileExplorerStore {
  workspacePath: string | null
  fileTree: FileNode[]
  expandedFolders: Set<string>
  searchQuery: string
  selectedFile: string | null

  loadFileTree: () => Promise<void>
  toggleFolder: (path: string) => void
  setSearchQuery: (query: string) => void
  selectFile: (path: string) => void
}
```

### 4. æ–‡ä»¶å›¾æ ‡æ˜ å°„

```typescript
const FILE_ICONS = {
  // è¯­è¨€æ–‡ä»¶
  '.ts': 'ğŸ”·',
  '.tsx': 'âš›ï¸',
  '.js': 'ğŸ“œ',
  '.jsx': 'âš›ï¸',
  '.json': 'ğŸ“‹',
  '.md': 'ğŸ“',

  // é…ç½®æ–‡ä»¶
  'package.json': 'ğŸ“¦',
  'tsconfig.json': 'ğŸ”§',
  '.gitignore': 'ğŸ™ˆ',

  // å…¶ä»–
  'directory': 'ğŸ“',
  'default': 'ğŸ“„',
}
```

### 5. è¿‡æ»¤è§„åˆ™

```typescript
const DEFAULT_IGNORE = [
  'node_modules',
  '.git',
  'dist',
  'build',
  'out',
  '.next',
  '.DS_Store',
  '*.log',
]
```

## API å®ç°

### ä¸»è¿›ç¨‹ IPC Handler

```typescript
// src/main/ipc/workspace.ts
import { ipcMain } from 'electron'
import fs from 'fs/promises'
import path from 'path'
import { watch } from 'chokidar'

export function setupWorkspaceHandlers() {
  // åˆ—å‡ºæ–‡ä»¶
  ipcMain.handle('workspace:list-files', async (_, dirPath: string) => {
    const files = await fs.readdir(dirPath, { withFileTypes: true })
    return files.map(file => ({
      name: file.name,
      path: path.join(dirPath, file.name),
      type: file.isDirectory() ? 'directory' : 'file',
      extension: file.isFile() ? path.extname(file.name) : undefined,
    }))
  })

  // ç›‘å¬æ–‡ä»¶å˜åŒ–
  ipcMain.on('workspace:watch', (event, dirPath: string) => {
    const watcher = watch(dirPath, {
      ignored: /(^|[\/\\])\../, // ignore dotfiles
      persistent: true,
    })

    watcher.on('change', () => {
      event.sender.send('workspace:files-changed')
    })
  })
}
```

### Preload API

```typescript
// src/preload/index.ts
export const api = {
  workspace: {
    listFiles: (path: string) =>
      ipcRenderer.invoke('workspace:list-files', path),

    watchFiles: (callback: () => void) => {
      ipcRenderer.on('workspace:files-changed', callback)
    },

    unwatchFiles: () => {
      ipcRenderer.removeAllListeners('workspace:files-changed')
    },
  }
}
```

## å®ç°ä¼˜å…ˆçº§

### é«˜ä¼˜å…ˆçº§ï¼ˆä»Šæ—¥å®Œæˆï¼‰
- [x] FileExplorer ä¸»ç»„ä»¶
- [x] FileTree æ–‡ä»¶æ ‘æ˜¾ç¤º
- [x] FileTreeItem å•é¡¹æ˜¾ç¤º
- [x] å±•å¼€/æŠ˜å åŠŸèƒ½
- [x] æ–‡ä»¶å›¾æ ‡
- [x] åŸºæœ¬è¿‡æ»¤ï¼ˆå¿½ç•¥ node_modules ç­‰ï¼‰
- [x] é›†æˆåˆ°ä¸»å¸ƒå±€

### ä¸­ä¼˜å…ˆçº§ï¼ˆåç»­ä¼˜åŒ–ï¼‰
- [ ] æ–‡ä»¶æœç´¢
- [ ] å³é”®èœå•
- [ ] æ–‡ä»¶ç›‘å¬ï¼ˆå®æ—¶æ›´æ–°ï¼‰
- [ ] æ€§èƒ½ä¼˜åŒ–ï¼ˆè™šæ‹Ÿæ»šåŠ¨ï¼‰

### ä½ä¼˜å…ˆçº§ï¼ˆæœªæ¥å¢å¼ºï¼‰
- [ ] æ–‡ä»¶æ“ä½œï¼ˆæ–°å»ºã€é‡å‘½åã€åˆ é™¤ï¼‰
- [ ] æ‹–æ‹½æ”¯æŒ
- [ ] è‡ªå®šä¹‰è¿‡æ»¤è§„åˆ™
- [ ] æ–‡ä»¶æ’åº

## ç”¨æˆ·äº¤äº’æµç¨‹

### åœºæ™¯ 1ï¼šæµè§ˆæ–‡ä»¶
```
1. ç”¨æˆ·é€‰æ‹©å·¥ä½œåŒº
2. æ–‡ä»¶æµè§ˆå™¨è‡ªåŠ¨åŠ è½½æ–‡ä»¶æ ‘
3. ç”¨æˆ·ç‚¹å‡»æ–‡ä»¶å¤¹å±•å¼€
4. ç‚¹å‡»æ–‡ä»¶æŸ¥çœ‹è·¯å¾„/é¢„è§ˆ
```

### åœºæ™¯ 2ï¼šæœç´¢æ–‡ä»¶
```
1. åœ¨æœç´¢æ¡†è¾“å…¥æ–‡ä»¶å
2. å®æ—¶è¿‡æ»¤æ˜¾ç¤ºåŒ¹é…æ–‡ä»¶
3. é«˜äº®åŒ¹é…éƒ¨åˆ†
4. ç‚¹å‡»ç»“æœè·³è½¬
```

### åœºæ™¯ 3ï¼šé…åˆ AI ä½¿ç”¨
```
1. ç”¨æˆ·åœ¨æ–‡ä»¶æµè§ˆå™¨ä¸­é€‰æ‹©æ–‡ä»¶
2. æ–‡ä»¶è·¯å¾„å¤åˆ¶åˆ°å‰ªè´´æ¿
3. åœ¨å¯¹è¯ä¸­æåŠè¯¥æ–‡ä»¶
4. AI å¯ä»¥è¯»å–è¯¥æ–‡ä»¶è¿›è¡Œåˆ†æ
```

## æ ·å¼è®¾è®¡

### é¢œè‰²æ–¹æ¡ˆ
```css
/* æ–‡ä»¶å¤¹ */
.folder {
  color: hsl(var(--primary));
}

/* æ–‡ä»¶ */
.file {
  color: hsl(var(--foreground));
}

/* æ‚¬åœ */
.item:hover {
  background: hsl(var(--accent));
}

/* é€‰ä¸­ */
.item-selected {
  background: hsl(var(--primary) / 0.1);
  border-left: 2px solid hsl(var(--primary));
}
```

### å“åº”å¼
- æœ€å°å®½åº¦ï¼š200px
- é»˜è®¤å®½åº¦ï¼š280px
- å¯è°ƒæ•´å®½åº¦ï¼ˆæ‹–æ‹½åˆ†éš”çº¿ï¼‰

## æ€§èƒ½è€ƒè™‘

1. **å¤§å‹é¡¹ç›®ä¼˜åŒ–**
   - æ‡’åŠ è½½å­æ–‡ä»¶å¤¹
   - è™šæ‹Ÿæ»šåŠ¨ï¼ˆreact-windowï¼‰
   - é™åˆ¶åˆå§‹å±•å¼€æ·±åº¦

2. **æ–‡ä»¶ç›‘å¬**
   - ä½¿ç”¨ chokidar é«˜æ•ˆç›‘å¬
   - é˜²æŠ–æ›´æ–°ï¼ˆé¿å…é¢‘ç¹åˆ·æ–°ï¼‰
   - ä»…ç›‘å¬å½“å‰å·¥ä½œåŒº

3. **æœç´¢ä¼˜åŒ–**
   - é˜²æŠ–æœç´¢è¾“å…¥
   - ç´¢å¼•æ–‡ä»¶è·¯å¾„
   - é™åˆ¶æœç´¢ç»“æœæ•°é‡

## æµ‹è¯•åœºæ™¯

1. ç©ºå·¥ä½œåŒºå¤„ç†
2. å¤§å‹é¡¹ç›®ï¼ˆ>1000 æ–‡ä»¶ï¼‰
3. æ·±å±‚åµŒå¥—ç›®å½•
4. æ–‡ä»¶ååŒ…å«ç‰¹æ®Šå­—ç¬¦
5. æ–‡ä»¶å®æ—¶å˜åŒ–

## æŠ€æœ¯æ ˆ

- React Hooks (useState, useEffect)
- Lucide React (å›¾æ ‡)
- Tailwind CSS (æ ·å¼)
- Chokidar (æ–‡ä»¶ç›‘å¬)
- å¯é€‰ï¼šreact-window (è™šæ‹Ÿæ»šåŠ¨)
